---
title: Security Directory를 이용한 가짜 서명
categories: [PE]
tags: [TEST]
---

## 서명 조작
최근 들어, 유효하지 않은 형태로 서명된 해킹툴이 많이 보이고 있습니다. 아래 사진은 게임 메모리를 조작하는 DLL 파일인데 'Microsoft Corporation'으로 서명되어 있습니다.
![](/assets/posts/images/2023-11-01-TEST/1.png)

이러한 가짜 서명은 안티치트를 우회하는 목적으로 사용되며, 주로 유저 레벨에서 동작하는 실행 파일(exe, dll)에서 발견되고 있습니다. 

## Security Directory
SignTool을 사용하여 서명이 됐을 때와 안됐을 때의 차이점을 직접 알아보겠습니다. 왼쪽은 서명 전, 오른쪽은 서명 후 바이너리 데이터입니다.
![](/assets/posts/images/2023-11-01-TEST/2.png)
![](/assets/posts/images/2023-11-01-TEST/3.png)

서명된 후에는 Security Directory가 변경되고, 파일 끝에 인증서와 관련된 바이너리 데이터가 추가됩니다.
![](/assets/posts/images/2023-11-01-TEST/4.png)

또한 파일에 대한 CheckSum 값이 추가되었습니다.
![](/assets/posts/images/2023-11-01-TEST/5.png)

정리하자면 서명 후 변경되는 데이터들은 다음과 같습니다.
||서명 후 변경점|
|--|--|
|1|Security Direcotry|
|2|CheckSum|
|3|Certificate Binary (end of file)

## HackTool DLL
서명 후 변경되는 데이터들을 비교하여 해킹툴 DLL을 살펴보겠습니다.  

## POC Code